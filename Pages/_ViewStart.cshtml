@using Newtonsoft.Json
@using Newtonsoft.Json.Linq
@using Models


@{
    // Declare object variable for later use
    object user = null;

    // Get the string inside the cookie an check so it isn't empty
    if (!String.IsNullOrEmpty(Context.Session.GetString("LoggedInCookie")))
    {
        // Try deserializing as Administrator
        user = JsonConvert.DeserializeObject<Administrator>(Context.Session.GetString("LoggedInCookie"));
        // If no success
        if (user == null)
        {
            // Try deserializing as Customer
            user = JsonConvert.DeserializeObject<Customer>(Context.Session.GetString("LoggedInCookie"));

            // If still no success
            if (user == null)
            {
                // Set user to null
                user = null;
            }
        }
    }


    // Load different page layouts depending on if the user is an administrator or not
    if (user is Administrator)
    {
        Layout = "_Layout_Admin";
    }
    else // If Customer or not logged in, show standard layout
    {
        Layout = "_Layout";
    }
}
