@using Newtonsoft.Json
@using Newtonsoft.Json.Linq
@using Models


@{
    // Initialize object for later use
    object user = null;

    // Get the string inside the cookie
    string loggedInCookie = Context.Session.GetString("LoggedInCookie");

    // If cookie isn't empty
    if (!string.IsNullOrEmpty(loggedInCookie))
    {
        // Deserialize the object from json-string
        JObject jObject = JsonConvert.DeserializeObject<JObject>(loggedInCookie);

        // If the loggedInCookie contains the value "Administrator" for the key "Role"
        if (jObject["Role"].ToString() == "Administrator")
        {
            // Make user an Administrator object
            user = jObject.ToObject<Administrator>();
        }
        // If the loggedInCookie contains the value "Customer" for the key "Role"
        else if (jObject["Role"].ToString() == "Customer")
        {
            // Make user a Customer object
            user = jObject.ToObject<Customer>();
        }
    }

    // Load different page layouts depending on if the user is an administrator or not
    if (user is Administrator)
    {
        Layout = "_Layout_Admin";
    }
    else // If Customer or not logged in, show standard layout
    {
        Layout = "_Layout";
    }
}
